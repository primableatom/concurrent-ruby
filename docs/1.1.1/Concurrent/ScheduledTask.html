<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Concurrent::ScheduledTask
  
    &mdash; Concurrent Ruby
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Concurrent::ScheduledTask";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span>
     &raquo; 
    <span class="title">ScheduledTask</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Concurrent::ScheduledTask
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'>Concurrent::Synchronization::LockableObject</span></li>
          
            <li class="next"><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></li>
          
            <li class="next">Concurrent::ScheduledTask</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Comparable</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/concurrent/scheduled_task.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Time calculations on all platforms and languages are sensitive to
changes to the system clock. To alleviate the potential problems
associated with changing the system clock while an application is running,
most modern operating systems provide a monotonic clock that operates
independently of the system clock. A monotonic clock cannot be used to
determine human-friendly clock times. A monotonic clock is used exclusively
for calculating time intervals. Not all Ruby platforms provide access to an
operating system monotonic clock. On these platforms a pure-Ruby monotonic
clock will be used as a fallback. An operating system monotonic clock is both
faster and more reliable than the pure-Ruby implementation. The pure-Ruby
implementation should be fast and reliable enough for most non-realtime
operations. At this time the common Ruby platforms that provide access to an
operating system monotonic clock are MRI 2.1 and above and JRuby (all versions).</p>
</div>
  </div>

<p><code>ScheduledTask</code> is a close relative of <code>Concurrent::Future</code> but with one
important difference: A <code>Future</code> is set to execute as soon as possible
whereas a <code>ScheduledTask</code> is set to execute after a specified delay. This
implementation is loosely based on Java&#39;s
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html">ScheduledExecutorService</a>.
It is a more feature-rich variant of timer.</p>

<p>The <em>intended</em> schedule time of task execution is set on object construction
with the <code>delay</code> argument. The delay is a numeric (floating point or integer)
representing a number of seconds in the future. Any other value or a numeric
equal to or less than zero will result in an exception. The <em>actual</em> schedule
time of task execution is set when the <code>execute</code> method is called.</p>

<p>The constructor can also be given zero or more processing options. Currently
the only supported options are those recognized by the
<a href="Dereferenceable">Dereferenceable</a> module.</p>

<p>The final constructor argument is a block representing the task to be performed.
If no block is given an <code>ArgumentError</code> will be raised.</p>

<p><strong>States</strong></p>

<p><code>ScheduledTask</code> mixes in the  <a href="Obligation">Obligation</a> module thus giving it
&quot;future&quot; behavior. This includes the expected lifecycle states. <code>ScheduledTask</code>
has one additional state, however. While the task (block) is being executed the
state of the object will be <code>:processing</code>. This additional state is necessary
because it has implications for task cancellation.</p>

<p><strong>Cancellation</strong></p>

<p>A <code>:pending</code> task can be cancelled using the <code>#cancel</code> method. A task in any
other state, including <code>:processing</code>, cannot be cancelled. The <code>#cancel</code>
method returns a boolean indicating the success of the cancellation attempt.
A cancelled <code>ScheduledTask</code> cannot be restarted. It is immutable.</p>

<p><strong>Obligation and Observation</strong></p>

<p>The result of a <code>ScheduledTask</code> can be obtained either synchronously or
asynchronously. <code>ScheduledTask</code> mixes in both the <a href="Obligation">Obligation</a>
module and the
<a href="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html">Observable</a>
module from the Ruby standard library. With one exception <code>ScheduledTask</code>
behaves identically to <a href="Observable">Future</a> with regard to these modules.</p>

<h2>Copy Options</h2>

<p>Object references in Ruby are mutable. This can lead to serious
problems when the <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span> of an object is a mutable reference. Which
is always the case unless the value is a <code>Fixnum</code>, <code>Symbol</code>, or similar
&quot;primitive&quot; data type. Each instance can be configured with a few
options that can help protect the program from potentially dangerous
operations. Each of these options can be optionally set when the object
instance is created:</p>

<ul>
<li><code>:dup_on_deref</code> When true the object will call the <code>#dup</code> method on
the <code>value</code> object every time the <code>#value</code> method is called
(default: false)</li>
<li><code>:freeze_on_deref</code> When true the object will call the <code>#freeze</code>
method on the <code>value</code> object every time the <code>#value</code> method is called
(default: false)</li>
<li><code>:copy_on_deref</code> When given a <code>Proc</code> object the <code>Proc</code> will be run
every time   the <code>#value</code> method is called. The <code>Proc</code> will be given
the current <code>value</code> as its only argument and the result returned by
the block will be the return   value of the <code>#value</code> call. When <code>nil</code>
this option will be ignored (default: nil)</li>
</ul>

<p>When multiple deref options are set the order of operations is strictly defined.
The order of deref operations is:</p>

<ul>
<li><code>:copy_on_deref</code></li>
<li><code>:dup_on_deref</code></li>
<li><code>:freeze_on_deref</code></li>
</ul>

<p>Because of this ordering there is no need to <code>#freeze</code> an object created by a
provided <code>:copy_on_deref</code> block. Simply set <code>:freeze_on_deref</code> to <code>true</code>.
Setting both <code>:dup_on_deref</code> to <code>true</code> and <code>:freeze_on_deref</code> to <code>true</code> is
as close to the behavior of a &quot;pure&quot; functional language (like Erlang, Clojure,
or Haskell) as we are likely to get in Ruby.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Basic usage</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>concurrent</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>thread</span><span class='tstring_end'>&#39;</span></span>   <span class='comment'># for Queue
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>open-uri</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># for open(uri)
</span>
<span class='kw'>class</span> <span class='const'>Ticker</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_get_year_end_closing'>get_year_end_closing</span><span class='lparen'>(</span><span class='id identifier rubyid_symbol'>symbol</span><span class='comma'>,</span> <span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://ichart.finance.yahoo.com/table.csv?s=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_symbol'>symbol</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;a=11&amp;b=01&amp;c=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_year'>year</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;d=11&amp;e=31&amp;f=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_year'>year</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;g=m</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># Future
</span><span class='id identifier rubyid_price'>price</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Future.html" title="Concurrent::Future (class)">Future</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="Future.html#execute-class_method" title="Concurrent::Future.execute (method)">execute</a></span></span><span class='lbrace'>{</span> <span class='const'>Ticker</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_get_year_end_closing'>get_year_end_closing</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TWTR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2013</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='comment'>#=&gt; :pending
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>    <span class='comment'># do other stuff
</span><span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='comment'>#=&gt; 63.65
</span><span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='comment'>#=&gt; :fulfilled
</span>
<span class='comment'># ScheduledTask
</span><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="#execute-class_method" title="Concurrent::ScheduledTask.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='const'>Ticker</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_get_year_end_closing'>get_year_end_closing</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INTC</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2013</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='comment'>#=&gt; :pending
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>   <span class='comment'># do other stuff
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='comment'>#=&gt; 25.96</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Successful task execution</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::ScheduledTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What does the fox say?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; :unscheduled
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; pending
</span>
<span class='comment'># wait for it...
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_unscheduled?'>unscheduled?</span> <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>     <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_fulfilled?'>fulfilled?</span>   <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_rejected?'>rejected?</span>    <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>        <span class='comment'>#=&gt; &#39;What does the fox say?&#39;</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>One line creation and execution</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::ScheduledTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What does the fox say?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; pending
</span>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="#execute-class_method" title="Concurrent::ScheduledTask.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What do you get when you multiply 6 by 9?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; pending</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Failed task execution</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="#execute-class_method" title="Concurrent::ScheduledTask.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Call me maybe?</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>      <span class='comment'>#=&gt; true
</span>
<span class='comment'># wait for it...
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_unscheduled?'>unscheduled?</span> <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>     <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_fulfilled?'>fulfilled?</span>   <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_rejected?'>rejected?</span>    <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>        <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_reason'>reason</span>       <span class='comment'>#=&gt; #&lt;StandardError: Call me maybe?&gt;</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Task execution with observation</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_observer'>observer</span> <span class='op'>=</span> <span class='const'>Class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lbrace'>{</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The task completed at </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_content'> with value &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::ScheduledTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What does the fox say?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_add_observer'>add_observer</span><span class='lparen'>(</span><span class='id identifier rubyid_observer'>observer</span><span class='rparen'>)</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>      <span class='comment'>#=&gt; true
</span>
<span class='comment'># wait for it...
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>

<span class='comment'>#&gt;&gt; The task completed at 2013-11-07 12:26:09 -0500 with value &#39;What does the fox say?&#39;</span></code></pre>
    
  </div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="http://linux.die.net/man/3/clock_gettime" target="_parent" title="Linux clock_gettime(3)">Linux clock_gettime(3)</a></li>
    
      <li>timer</li>
    
  </ul>

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-class_method" title="execute (class method)">.<strong>execute</strong>(delay, opts = {}, &amp;task)  &#x21d2; ScheduledTask </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a new <code>ScheduledTask</code> object with the given block, execute it, and return the <code>:pending</code> object.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancel-instance_method" title="#cancel (instance method)">#<strong>cancel</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Cancel this task and prevent it from executing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancelled%3F-instance_method" title="#cancelled? (instance method)">#<strong>cancelled?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Has the task been cancelled?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-instance_method" title="#execute (instance method)">#<strong>execute</strong>  &#x21d2; ScheduledTask </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute an <code>:unscheduled</code> <code>ScheduledTask</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initial_delay-instance_method" title="#initial_delay (instance method)">#<strong>initial_delay</strong>  &#x21d2; Float </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The <code>delay</code> value given at instanciation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(delay, opts = {}) { ... } &#x21d2; ScheduledTask </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Schedule a task for execution at a specified future time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#processing%3F-instance_method" title="#processing? (instance method)">#<strong>processing?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>In the task execution in progress?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reschedule-instance_method" title="#reschedule (instance method)">#<strong>reschedule</strong>(delay)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Reschedule the task using the given delay and the current time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-instance_method" title="#reset (instance method)">#<strong>reset</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Reschedule the task using the original delay and the current time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#schedule_time-instance_method" title="#schedule_time (instance method)">#<strong>schedule_time</strong>  &#x21d2; Float </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The monotonic time at which the the task is scheduled to be executed.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(delay, opts = {}) { ... } &#x21d2; <tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Schedule a task for execution at a specified future time.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>delay</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the number of seconds to wait for before executing the task</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Hash.html" title="Concurrent::Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the options used to define the behavior at update and deref
and to specify the executor on which to perform actions</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:executor</span>
          <span class="type">(<tt>Executor</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>when set use the given <code>Executor</code> instance.
Three special values are also supported: <code>:io</code> returns the global pool for
long, blocking (IO) tasks, <code>:fast</code> returns the global pool for short, fast
operations, and <code>:immediate</code> returns the global <code>ImmediateExecutor</code> object.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:dup_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#dup</code> before
returning the data from <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:freeze_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#freeze</code> before
returning the data from <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:copy_on_deref</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>When calling the <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span>
method, call the given proc passing the internal value as the sole
argument then return the new value returned from the proc.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:args</span>
          <span class="type">(<tt>object</tt>, <tt><span class='object_link'><a href="Array.html" title="Concurrent::Array (class)">Array</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>zero or more arguments to be passed the task
block on execution</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>the task to be performed</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>When no block is given</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>When given a time that is in the past</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no block given</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>seconds must be greater than zero</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_delay'>delay</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>&lt;</span> <span class='float'>0.0</span>

  <span class='kw'>super</span><span class='lparen'>(</span><span class='const'>NULL</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='kw'>nil</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_ns_set_state'>ns_set_state</span><span class='lparen'>(</span><span class='symbol'>:unscheduled</span><span class='rparen'>)</span>
    <span class='ivar'>@parent</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:timer_set</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='period'>.</span><span class='id identifier rubyid_global_timer_set'><span class='object_link'><a href="../Concurrent.html#global_timer_set-class_method" title="Concurrent.global_timer_set (method)">global_timer_set</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@args</span> <span class='op'>=</span> <span class='id identifier rubyid_get_arguments_from'>get_arguments_from</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='ivar'>@delay</span> <span class='op'>=</span> <span class='id identifier rubyid_delay'>delay</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
    <span class='ivar'>@task</span> <span class='op'>=</span> <span class='id identifier rubyid_task'>task</span>
    <span class='ivar'>@time</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@executor</span> <span class='op'>=</span> <span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_executor_from_options'>executor_from_options</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='period'>.</span><span class='id identifier rubyid_global_io_executor'><span class='object_link'><a href="../Concurrent.html#global_io_executor-class_method" title="Concurrent.global_io_executor (method)">global_io_executor</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_observers'>observers</span> <span class='op'>=</span> <span class='const'>Collection</span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Collection/CopyOnNotifyObserverSet.html" title="Concurrent::Collection::CopyOnNotifyObserverSet (class)">CopyOnNotifyObserverSet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Collection/CopyOnNotifyObserverSet.html#initialize-instance_method" title="Concurrent::Collection::CopyOnNotifyObserverSet#initialize (method)">new</a></span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="execute-class_method">
  
    .<strong>execute</strong>(delay, opts = {}, &amp;task)  &#x21d2; <tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a new <code>ScheduledTask</code> object with the given block, execute it, and return the
<code>:pending</code> object.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>delay</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the number of seconds to wait for before executing the task</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Hash.html" title="Concurrent::Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the options used to define the behavior at update and deref
and to specify the executor on which to perform actions</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:executor</span>
          <span class="type">(<tt>Executor</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>when set use the given <code>Executor</code> instance.
Three special values are also supported: <code>:io</code> returns the global pool for
long, blocking (IO) tasks, <code>:fast</code> returns the global pool for short, fast
operations, and <code>:immediate</code> returns the global <code>ImmediateExecutor</code> object.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:dup_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#dup</code> before
returning the data from <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:freeze_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#freeze</code> before
returning the data from <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:copy_on_deref</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>When calling the <span class='object_link'><a href="Concern/Obligation.html#value-instance_method" title="Concurrent::Concern::Obligation#value (method)">Concern::Obligation#value</a></span>
method, call the given proc passing the internal value as the sole
argument then return the new value returned from the proc.</p>
</div>
          
        </li>
      
    </ul>
  
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the newly created <code>ScheduledTask</code> in the <code>:pending</code> state</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if no block is given</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


277
278
279</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 277</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cancel-instance_method">
  
    #<strong>cancel</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Cancel this task and prevent it from executing. A task can only be
cancelled if it is pending or unscheduled.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if successfully cancelled else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224
225
226
227
228
229
230
231</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancel'>cancel</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_compare_and_set_state'>compare_and_set_state</span><span class='lparen'>(</span><span class='symbol'>:cancelled</span><span class='comma'>,</span> <span class='symbol'>:pending</span><span class='comma'>,</span> <span class='symbol'>:unscheduled</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_complete'>complete</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Concurrent.html#CancelledOperationError-constant" title="Concurrent::CancelledOperationError (constant)">CancelledOperationError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>
    <span class='comment'># To avoid deadlocks this call must occur outside of #synchronize
</span>    <span class='comment'># Changing the state above should prevent redundant calls
</span>    <span class='ivar'>@parent</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:remove_task</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cancelled?-instance_method">
  
    #<strong>cancelled?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Has the task been cancelled?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if the task is in the given state else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 207</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancelled?'>cancelled?</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_ns_check_state?'>ns_check_state?</span><span class='lparen'>(</span><span class='symbol'>:cancelled</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute-instance_method">
  
    #<strong>execute</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute an <code>:unscheduled</code> <code>ScheduledTask</code>. Immediately sets the state to <code>:pending</code>
and starts counting down toward execution. Does nothing if the <code>ScheduledTask</code> is
in any state other than <code>:unscheduled</code>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a reference to <code>self</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


260
261
262
263
264
265</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 260</span>

<span class='kw'>def</span> <span class='id identifier rubyid_execute'>execute</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_compare_and_set_state'>compare_and_set_state</span><span class='lparen'>(</span><span class='symbol'>:pending</span><span class='comma'>,</span> <span class='symbol'>:unscheduled</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_synchronize'>synchronize</span><span class='lbrace'>{</span> <span class='id identifier rubyid_ns_schedule'>ns_schedule</span><span class='lparen'>(</span><span class='ivar'>@delay</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initial_delay-instance_method">
  
    #<strong>initial_delay</strong>  &#x21d2; <tt>Float</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The <code>delay</code> value given at instanciation.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the initial delay.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 186</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initial_delay'>initial_delay</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span> <span class='ivar'>@delay</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="processing?-instance_method">
  
    #<strong>processing?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>In the task execution in progress?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if the task is in the given state else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 214</span>

<span class='kw'>def</span> <span class='id identifier rubyid_processing?'>processing?</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_ns_check_state?'>ns_check_state?</span><span class='lparen'>(</span><span class='symbol'>:processing</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reschedule-instance_method">
  
    #<strong>reschedule</strong>(delay)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Reschedule the task using the given delay and the current time.
A task can only be reset while it is <code>:pending</code>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>delay</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the number of seconds to wait for before executing the task</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if successfully rescheduled else false</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>When given a time that is in the past</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 249</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reschedule'>reschedule</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_delay'>delay</span> <span class='op'>=</span> <span class='id identifier rubyid_delay'>delay</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>seconds must be greater than zero</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_delay'>delay</span> <span class='op'>&lt;</span> <span class='float'>0.0</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span><span class='lbrace'>{</span> <span class='id identifier rubyid_ns_reschedule'>ns_reschedule</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset-instance_method">
  
    #<strong>reset</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Reschedule the task using the original delay and the current time.
A task can only be reset while it is <code>:pending</code>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if successfully rescheduled else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


237
238
239</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 237</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset'>reset</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span><span class='lbrace'>{</span> <span class='id identifier rubyid_ns_reschedule'>ns_reschedule</span><span class='lparen'>(</span><span class='ivar'>@delay</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="schedule_time-instance_method">
  
    #<strong>schedule_time</strong>  &#x21d2; <tt>Float</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The monotonic time at which the the task is scheduled to be executed.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the schedule time or nil if <code>unscheduled</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schedule_time'>schedule_time</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span> <span class='ivar'>@time</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_blank">yard</a>.
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57940973-1', 'auto');
  ga('send', 'pageview');

</script>

    </div>
  </body>
</html>