<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Concurrent::TimerTask
  
    &mdash; Concurrent Ruby
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Concurrent::TimerTask";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span>
     &raquo; 
    <span class="title">TimerTask</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Concurrent::TimerTask
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'>RubyExecutorService</span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'>Synchronization::LockableObject</span></li>
          
            <li class="next"><span class='object_link'>AbstractExecutorService</span></li>
          
            <li class="next"><span class='object_link'>RubyExecutorService</span></li>
          
            <li class="next">Concurrent::TimerTask</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Concern/Dereferenceable.html" title="Concurrent::Concern::Dereferenceable (module)">Concern::Dereferenceable</a></span>, <span class='object_link'><a href="Concern/Observable.html" title="Concurrent::Concern::Observable (module)">Concern::Observable</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/concurrent/timer_task.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A very common concurrency pattern is to run a thread that performs a task at
regular intervals. The thread that performs the task sleeps for the given
interval then wakes up and performs the task. Lather, rinse, repeat... This
pattern causes two problems. First, it is difficult to test the business
logic of the task because the task itself is tightly coupled with the
concurrency logic. Second, an exception raised while performing the task can
cause the entire thread to abend. In a long-running application where the
task thread is intended to run for days/weeks/years a crashed task thread
can pose a significant problem. <code>TimerTask</code> alleviates both problems.</p>

<p>When a <code>TimerTask</code> is launched it starts a thread for monitoring the
execution interval. The <code>TimerTask</code> thread does not perform the task,
however. Instead, the TimerTask launches the task on a separate thread.
Should the task experience an unrecoverable crash only the task thread will
crash. This makes the <code>TimerTask</code> very fault tolerant. Additionally, the
<code>TimerTask</code> thread can respond to the success or failure of the task,
performing logging or ancillary operations. <code>TimerTask</code> can also be
configured with a timeout value allowing it to kill a task that runs too
long.</p>

<p>One other advantage of <code>TimerTask</code> is that it forces the business logic to
be completely decoupled from the concurrency logic. The business logic can
be tested separately then passed to the <code>TimerTask</code> for scheduling and
running.</p>

<p>In some cases it may be necessary for a <code>TimerTask</code> to affect its own
execution cycle. To facilitate this, a reference to the TimerTask instance
is passed as an argument to the provided block every time the task is
executed.</p>

<p>The <code>TimerTask</code> class includes the <code>Dereferenceable</code> mixin module so the
result of the last execution is always available via the <code>#value</code> method.
Dereferencing options can be passed to the <code>TimerTask</code> during construction or
at any later time using the <code>#set_deref_options</code> method.</p>

<p><code>TimerTask</code> supports notification through the Ruby standard library
<a href="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html" target="_parent" title="Observable">Observable</a> module. On execution the <code>TimerTask</code> will notify the observers
with three arguments: time of execution, the result of the block (or nil on
failure), and any raised exceptions (or nil on success). If the timeout
interval is exceeded the observer will receive a <code>Concurrent::TimeoutError</code>
object as the third argument.</p>

<h2>Copy Options</h2>

<p>Object references in Ruby are mutable. This can lead to serious
problems when the <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span> of an object is a mutable reference. Which
is always the case unless the value is a <code>Fixnum</code>, <code>Symbol</code>, or similar
&quot;primitive&quot; data type. Each instance can be configured with a few
options that can help protect the program from potentially dangerous
operations. Each of these options can be optionally set when the object
instance is created:</p>

<ul>
<li><code>:dup_on_deref</code> When true the object will call the <code>#dup</code> method on
the <code>value</code> object every time the <code>#value</code> method is called
(default: false)</li>
<li><code>:freeze_on_deref</code> When true the object will call the <code>#freeze</code>
method on the <code>value</code> object every time the <code>#value</code> method is called
(default: false)</li>
<li><code>:copy_on_deref</code> When given a <code>Proc</code> object the <code>Proc</code> will be run
every time   the <code>#value</code> method is called. The <code>Proc</code> will be given
the current <code>value</code> as its only argument and the result returned by
the block will be the return   value of the <code>#value</code> call. When <code>nil</code>
this option will be ignored (default: nil)</li>
</ul>

<p>When multiple deref options are set the order of operations is strictly defined.
The order of deref operations is:</p>

<ul>
<li><code>:copy_on_deref</code></li>
<li><code>:dup_on_deref</code></li>
<li><code>:freeze_on_deref</code></li>
</ul>

<p>Because of this ordering there is no need to <code>#freeze</code> an object created by a
provided <code>:copy_on_deref</code> block. Simply set <code>:freeze_on_deref</code> to <code>true</code>.
Setting both <code>:dup_on_deref</code> to <code>true</code> and <code>:freeze_on_deref</code> to <code>true</code> is
as close to the behavior of a &quot;pure&quot; functional language (like Erlang, Clojure,
or Haskell) as we are likely to get in Ruby.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Basic usage</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lbrace'>{</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boom!</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execution_interval'>execution_interval</span> <span class='comment'>#=&gt; 60 (default)
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_timeout_interval'>timeout_interval</span>   <span class='comment'>#=&gt; 30 (default)
</span>
<span class='comment'># wait 60 seconds...
</span><span class='comment'>#=&gt; &#39;Boom!&#39;
</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span> <span class='comment'>#=&gt; true</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Configuring <code>:execution_interval</code> and <code>:timeout_interval</code></p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>5</span><span class='comma'>,</span> <span class='label'>timeout_interval:</span> <span class='int'>5</span><span class='rparen'>)</span> <span class='kw'>do</span>
       <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boom!</span><span class='tstring_end'>&#39;</span></span>
     <span class='kw'>end</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execution_interval'>execution_interval</span> <span class='comment'>#=&gt; 5
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_timeout_interval'>timeout_interval</span>   <span class='comment'>#=&gt; 5</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Immediate execution with <code>:run_now</code></p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>run_now:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boom!</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>

<span class='comment'>#=&gt; &#39;Boom!&#39;</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Last <code>#value</code> and <code>Dereferenceable</code> mixin</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span>
  <span class='label'>dup_on_deref:</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='label'>execution_interval:</span> <span class='int'>5</span>
<span class='rparen'>)</span><span class='lbrace'>{</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='rbrace'>}</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>   <span class='comment'>#=&gt; 2013-11-07 18:06:50 -0500
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='comment'>#=&gt; 2013-11-07 18:06:55 -0500</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Controlling execution from within the block</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_timer_task'>timer_task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='op'>|</span>
  <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execution_interval'>execution_interval</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='lbrace'>{</span> <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boom! </span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execution_interval'>execution_interval</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execution_interval'>execution_interval</span> <span class='op'>&gt;</span> <span class='int'>5</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stopping...</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_timer_task'>timer_task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span> <span class='comment'># blocking call - this task will stop itself
</span><span class='comment'>#=&gt; Boom!
</span><span class='comment'>#=&gt; Boom! Boom!
</span><span class='comment'>#=&gt; Boom! Boom! Boom!
</span><span class='comment'>#=&gt; Boom! Boom! Boom! Boom!
</span><span class='comment'>#=&gt; Boom! Boom! Boom! Boom! Boom!
</span><span class='comment'>#=&gt; Stopping...</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Observation</p>
</div></p>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>TaskObserver</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_ex'>ex</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span>
      <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_content'>) Execution successfully returned </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_ex'>ex</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Concurrent.html#TimeoutError-constant" title="Concurrent::TimeoutError (constant)">TimeoutError</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_content'>) Execution timed out\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_content'>) Execution failed with error </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ex'>ex</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>timeout_interval:</span> <span class='int'>1</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='int'>42</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_add_observer'>add_observer</span><span class='lparen'>(</span><span class='const'>TaskObserver</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_sleep'>sleep</span> <span class='int'>4</span>

<span class='comment'>#=&gt; (2013-10-13 19:08:58 -0400) Execution successfully returned 42
</span><span class='comment'>#=&gt; (2013-10-13 19:08:59 -0400) Execution successfully returned 42
</span><span class='comment'>#=&gt; (2013-10-13 19:09:00 -0400) Execution successfully returned 42
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span>

<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>timeout_interval:</span> <span class='int'>1</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_sleep'>sleep</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_add_observer'>add_observer</span><span class='lparen'>(</span><span class='const'>TaskObserver</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>

<span class='comment'>#=&gt; (2013-10-13 19:07:25 -0400) Execution timed out
</span><span class='comment'>#=&gt; (2013-10-13 19:07:27 -0400) Execution timed out
</span><span class='comment'>#=&gt; (2013-10-13 19:07:29 -0400) Execution timed out
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span>

<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'>TimerTask</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>1</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_add_observer'>add_observer</span><span class='lparen'>(</span><span class='const'>TaskObserver</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>

<span class='comment'>#=&gt; (2013-10-13 19:09:37 -0400) Execution failed with error StandardError
</span><span class='comment'>#=&gt; (2013-10-13 19:09:38 -0400) Execution failed with error StandardError
</span><span class='comment'>#=&gt; (2013-10-13 19:09:39 -0400) Execution failed with error StandardError
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span></code></pre>
    
  </div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html" target="_parent" title="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html">http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html</a></li>
    
      <li><a href="http://docs.oracle.com/javase/7/docs/api/java/util/TimerTask.html" target="_parent" title="http://docs.oracle.com/javase/7/docs/api/java/util/TimerTask.html">http://docs.oracle.com/javase/7/docs/api/java/util/TimerTask.html</a></li>
    
  </ul>

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="EXECUTION_INTERVAL-constant" class="">EXECUTION_INTERVAL =
          <div class="docstring">
  <div class="discussion">
    <p>Default <code>:execution_interval</code> in seconds.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>60</span></pre></dd>
      
        <dt id="TIMEOUT_INTERVAL-constant" class="">TIMEOUT_INTERVAL =
          <div class="docstring">
  <div class="discussion">
    <p>Default <code>:timeout_interval</code> in seconds.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>30</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#execution_interval-instance_method" title="#execution_interval (instance method)">#<strong>execution_interval</strong>  &#x21d2; Fixnum </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Number of seconds after the task completes before the task is performed again.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout_interval-instance_method" title="#timeout_interval (instance method)">#<strong>timeout_interval</strong>  &#x21d2; Fixnum </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Number of seconds the task can run before it is considered to have failed.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-class_method" title="execute (class method)">.<strong>execute</strong>(opts = {}) {|task| ... } &#x21d2; TimerTask </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create and execute a new <code>TimerTask</code>.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_observer-instance_method" title="#add_observer (instance method)">#<strong>add_observer</strong>(observer = nil, func = :update, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Concern/Observable.html#add_observer-instance_method" title="Concurrent::Concern::Observable#add_observer (method)">Concern::Observable</a></span>
    </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Adds an observer to this set.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#count_observers-instance_method" title="#count_observers (instance method)">#<strong>count_observers</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Concern/Observable.html#count_observers-instance_method" title="Concurrent::Concern::Observable#count_observers (method)">Concern::Observable</a></span>
    </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Return the number of observers associated with this object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_observer-instance_method" title="#delete_observer (instance method)">#<strong>delete_observer</strong>(observer)  &#x21d2; Object </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Concern/Observable.html#delete_observer-instance_method" title="Concurrent::Concern::Observable#delete_observer (method)">Concern::Observable</a></span>
    </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Remove <code>observer</code> as an observer on this object so that it will no longer receive notifications.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_observers-instance_method" title="#delete_observers (instance method)">#<strong>delete_observers</strong>  &#x21d2; Observable </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Concern/Observable.html#delete_observers-instance_method" title="Concurrent::Concern::Observable#delete_observers (method)">Concern::Observable</a></span>
    </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Remove all observers associated with this object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-instance_method" title="#execute (instance method)">#<strong>execute</strong>  &#x21d2; TimerTask </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a previously created <code>TimerTask</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(opts = {}) {|task| ... } &#x21d2; TimerTask </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a new TimerTask with the given task and configuration.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#running%3F-instance_method" title="#running? (instance method)">#<strong>running?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Is the executor running?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#value-instance_method" title="#value (instance method)">#<strong>value</strong>  &#x21d2; Object </a>
    

    
      (also: #deref)
    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable</a></span>
    </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Return the value this object represents after applying the options specified by the <code>#set_deref_options</code> method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_observer-instance_method" title="#with_observer (instance method)">#<strong>with_observer</strong>(observer = nil, func = :update, &amp;block)  &#x21d2; Observable </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Concern/Observable.html#with_observer-instance_method" title="Concurrent::Concern::Observable#with_observer (method)">Concern::Observable</a></span>
    </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>As <code>#add_observer</code> but can be used for chaining.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(opts = {}) {|task| ... } &#x21d2; <tt><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a new TimerTask with the given task and configuration.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Hash.html" title="Concurrent::Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the options defining task execution.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:execution_interval</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>number of seconds between
task executions (default: EXECUTION_INTERVAL)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:timeout_interval</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>number of seconds a task can
run before it is considered to have failed (default: TIMEOUT_INTERVAL)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:run_now</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Whether to run the task immediately
upon instantiation or to wait until the first #  execution_interval
has passed (default: false)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:dup_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#dup</code> before
returning the data from <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:freeze_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#freeze</code> before
returning the data from <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:copy_on_deref</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>When calling the <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span>
method, call the given proc passing the internal value as the sole
argument then return the new value returned from the proc.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>to the block after :execution_interval seconds have passed since
the last yield</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>task</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>a reference to the <code>TimerTask</code> instance so that the
block can control its own lifecycle. Necessary since <code>self</code> will
refer to the execution context of the block rather than the running
<code>TimerTask</code>.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>ArgumentError when no block is given.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/timer_task.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no block given</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>super</span>
  <span class='id identifier rubyid_set_deref_options'>set_deref_options</span> <span class='id identifier rubyid_opts'>opts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="execution_interval=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="execution_interval-instance_method">
  
    #<strong>execution_interval</strong>  &#x21d2; <tt>Fixnum</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns Number of seconds after the task completes before the
task is performed again.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Number of seconds after the task completes before the
task is performed again.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/timer_task.rb', line 240</span>

<span class='kw'>def</span> <span class='id identifier rubyid_execution_interval'>execution_interval</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span> <span class='ivar'>@execution_interval</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="timeout_interval=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="timeout_interval-instance_method">
  
    #<strong>timeout_interval</strong>  &#x21d2; <tt>Fixnum</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns Number of seconds the task can run before it is
considered to have failed.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Number of seconds the task can run before it is
considered to have failed.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/timer_task.rb', line 258</span>

<span class='kw'>def</span> <span class='id identifier rubyid_timeout_interval'>timeout_interval</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span> <span class='ivar'>@timeout_interval</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="execute-class_method">
  
    .<strong>execute</strong>(opts = {}) {|task| ... } &#x21d2; <tt><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create and execute a new <code>TimerTask</code>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>10</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello World\n</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_running?'>running?</span> <span class='comment'>#=&gt; true</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Hash.html" title="Concurrent::Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the options defining task execution.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:execution_interval</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>number of seconds between
task executions (default: EXECUTION_INTERVAL)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:timeout_interval</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>number of seconds a task can
run before it is considered to have failed (default: TIMEOUT_INTERVAL)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:run_now</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Whether to run the task immediately
upon instantiation or to wait until the first #  execution_interval
has passed (default: false)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:dup_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#dup</code> before
returning the data from <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:freeze_on_deref</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>Call <code>#freeze</code> before
returning the data from <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span></p>
</div>
          
        </li>
      
        <li>
          <span class="name">:copy_on_deref</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>When calling the <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable#value</a></span>
method, call the given proc passing the internal value as the sole
argument then return the new value returned from the proc.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>to the block after :execution_interval seconds have passed since
the last yield</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>task</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>a reference to the <code>TimerTask</code> instance so that the
block can control its own lifecycle. Necessary since <code>self</code> will
refer to the execution context of the block rather than the running
<code>TimerTask</code>.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the new <code>TimerTask</code></p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>ArgumentError when no block is given.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/timer_task.rb', line 233</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_observer-instance_method">
  
    #<strong>add_observer</strong>(observer = nil, func = :update, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Concern/Observable.html#add_observer-instance_method" title="Concurrent::Concern::Observable#add_observer (method)">Concern::Observable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Adds an observer to this set. If a block is passed, the observer will be
created by this method and no other params should be passed.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>observer</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the observer to add</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>func</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:update</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the function to call on the observer during notification.
Default is :update</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the added observer</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="count_observers-instance_method">
  
    #<strong>count_observers</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Concern/Observable.html#count_observers-instance_method" title="Concurrent::Concern::Observable#count_observers (method)">Concern::Observable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Return the number of observers associated with this object.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the observers count</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_observer-instance_method">
  
    #<strong>delete_observer</strong>(observer)  &#x21d2; <tt>Object</tt> 
  

  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Concern/Observable.html#delete_observer-instance_method" title="Concurrent::Concern::Observable#delete_observer (method)">Concern::Observable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Remove <code>observer</code> as an observer on this object so that it will no
longer receive notifications.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>observer</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the observer to remove</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the deleted observer</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_observers-instance_method">
  
    #<strong>delete_observers</strong>  &#x21d2; <tt><span class='object_link'><a href="Concern/Observable.html" title="Concurrent::Concern::Observable (module)">Observable</a></span></tt> 
  

  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Concern/Observable.html#delete_observers-instance_method" title="Concurrent::Concern::Observable#delete_observers (method)">Concern::Observable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Remove all observers associated with this object.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Concern/Observable.html" title="Concurrent::Concern::Observable (module)">Observable</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>self</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute-instance_method">
  
    #<strong>execute</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a previously created <code>TimerTask</code>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Instance and execute in separate steps</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>10</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello World\n</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_running?'>running?</span> <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_running?'>running?</span> <span class='comment'>#=&gt; true</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Instance and execute in one line</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Concurrent::TimerTask#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>execution_interval:</span> <span class='int'>10</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello World\n</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_running?'>running?</span> <span class='comment'>#=&gt; true</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::TimerTask (class)">TimerTask</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a reference to <code>self</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/timer_task.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_execute'>execute</span>
  <span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@running</span><span class='period'>.</span><span class='id identifier rubyid_false?'>false?</span>
      <span class='ivar'>@running</span><span class='period'>.</span><span class='id identifier rubyid_make_true'>make_true</span>
      <span class='id identifier rubyid_schedule_next_task'>schedule_next_task</span><span class='lparen'>(</span><span class='ivar'>@run_now</span> <span class='op'>?</span> <span class='int'>0</span> <span class='op'>:</span> <span class='ivar'>@execution_interval</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="running?-instance_method">
  
    #<strong>running?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Is the executor running?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p><code>true</code> when running, <code>false</code> when shutting down or shutdown</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/timer_task.rb', line 199</span>

<span class='kw'>def</span> <span class='id identifier rubyid_running?'>running?</span>
  <span class='ivar'>@running</span><span class='period'>.</span><span class='id identifier rubyid_true?'>true?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="value-instance_method">
  
    #<strong>value</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='deref-instance_method'>deref</span></span>
    </span>
  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Concern/Dereferenceable.html#value-instance_method" title="Concurrent::Concern::Dereferenceable#value (method)">Concern::Dereferenceable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Return the value this object represents after applying the options specified
by the <code>#set_deref_options</code> method.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the current value of the object</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_observer-instance_method">
  
    #<strong>with_observer</strong>(observer = nil, func = :update, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="Concern/Observable.html" title="Concurrent::Concern::Observable (module)">Observable</a></span></tt> 
  

  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Concern/Observable.html#with_observer-instance_method" title="Concurrent::Concern::Observable#with_observer (method)">Concern::Observable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>As <code>#add_observer</code> but can be used for chaining.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>observer</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the observer to add</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>func</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:update</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the function to call on the observer during notification.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Concern/Observable.html" title="Concurrent::Concern::Observable (module)">Observable</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>self</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_blank">yard</a>.
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57940973-1', 'auto');
  ga('send', 'pageview');

</script>

    </div>
  </body>
</html>